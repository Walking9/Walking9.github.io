<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Modemä»£ç†APå¿ƒè·³æ–¹æ¡ˆ | Walking9&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="åŸºäº LwIP çš„ Modem ä»£ç† AP å¿ƒè·³æ–¹æ¡ˆï¼šTCP&#x2F;IP åè®®æ ˆç§»æ¤ä¸å®è·µåœ¨æ™ºèƒ½æ‰‹æœºåŠŸè€—ä¼˜åŒ–é¢†åŸŸï¼ŒAPï¼ˆApplication Processorï¼Œåº”ç”¨å¤„ç†å™¨ï¼‰çš„ä¼‘çœ å”¤é†’ç­–ç•¥æ˜¯å…³é”®ç¯èŠ‚ã€‚è®¸å¤šåº”ç”¨ï¼ˆå¦‚å³æ—¶é€šè®¯ã€æ¨é€æœåŠ¡ï¼‰ä¾èµ–å‘¨æœŸæ€§å¿ƒè·³åŒ…ç»´æŒç½‘ç»œè¿æ¥ï¼Œè¿™ä¼šå¯¼è‡´ AP é¢‘ç¹ä»æ·±åº¦ä¼‘çœ ä¸­å”¤é†’ï¼Œæ˜¾è‘—å¢åŠ å¾…æœºåŠŸè€—ã€‚æœ¬æ–‡å°†ä»¥ TCP&#x2F;IP åè®®æ ˆä¸ºæŠ€æœ¯åˆ‡å…¥ç‚¹ï¼Œè¯¦ç»†ä»‹ç»ä¸€ç§é€šè¿‡ Mo">
<meta property="og:type" content="article">
<meta property="og:title" content="Modemä»£ç†APå¿ƒè·³æ–¹æ¡ˆ">
<meta property="og:url" content="https://walking9.github.io/2021/12/05/Modem%E4%BB%A3%E7%90%86AP%E5%BF%83%E8%B7%B3%E6%96%B9%E6%A1%88/index.html">
<meta property="og:site_name" content="Walking9&#39;s Blog">
<meta property="og:description" content="åŸºäº LwIP çš„ Modem ä»£ç† AP å¿ƒè·³æ–¹æ¡ˆï¼šTCP&#x2F;IP åè®®æ ˆç§»æ¤ä¸å®è·µåœ¨æ™ºèƒ½æ‰‹æœºåŠŸè€—ä¼˜åŒ–é¢†åŸŸï¼ŒAPï¼ˆApplication Processorï¼Œåº”ç”¨å¤„ç†å™¨ï¼‰çš„ä¼‘çœ å”¤é†’ç­–ç•¥æ˜¯å…³é”®ç¯èŠ‚ã€‚è®¸å¤šåº”ç”¨ï¼ˆå¦‚å³æ—¶é€šè®¯ã€æ¨é€æœåŠ¡ï¼‰ä¾èµ–å‘¨æœŸæ€§å¿ƒè·³åŒ…ç»´æŒç½‘ç»œè¿æ¥ï¼Œè¿™ä¼šå¯¼è‡´ AP é¢‘ç¹ä»æ·±åº¦ä¼‘çœ ä¸­å”¤é†’ï¼Œæ˜¾è‘—å¢åŠ å¾…æœºåŠŸè€—ã€‚æœ¬æ–‡å°†ä»¥ TCP&#x2F;IP åè®®æ ˆä¸ºæŠ€æœ¯åˆ‡å…¥ç‚¹ï¼Œè¯¦ç»†ä»‹ç»ä¸€ç§é€šè¿‡ Mo">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-12-04T16:04:58.000Z">
<meta property="article:modified_time" content="2025-08-04T16:05:41.018Z">
<meta property="article:author" content="Walking9">
<meta property="article:tag" content="åç«¯å¼€å‘,Linux,æ“ä½œç³»ç»Ÿ,æ•°æ®åº“,Coding">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Walking9's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Walking9&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I try to keep on moving</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS è®¢é˜…"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="æœç´¢"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="æœç´¢"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://walking9.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Modemä»£ç†APå¿ƒè·³æ–¹æ¡ˆ" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/12/05/Modem%E4%BB%A3%E7%90%86AP%E5%BF%83%E8%B7%B3%E6%96%B9%E6%A1%88/" class="article-date">
  <time class="dt-published" datetime="2021-12-04T16:04:58.000Z" itemprop="datePublished">2021-12-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Modemä»£ç†APå¿ƒè·³æ–¹æ¡ˆ
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="åŸºäº-LwIP-çš„-Modem-ä»£ç†-AP-å¿ƒè·³æ–¹æ¡ˆï¼šTCP-IP-åè®®æ ˆç§»æ¤ä¸å®è·µ"><a href="#åŸºäº-LwIP-çš„-Modem-ä»£ç†-AP-å¿ƒè·³æ–¹æ¡ˆï¼šTCP-IP-åè®®æ ˆç§»æ¤ä¸å®è·µ" class="headerlink" title="åŸºäº LwIP çš„ Modem ä»£ç† AP å¿ƒè·³æ–¹æ¡ˆï¼šTCP&#x2F;IP åè®®æ ˆç§»æ¤ä¸å®è·µ"></a>åŸºäº LwIP çš„ Modem ä»£ç† AP å¿ƒè·³æ–¹æ¡ˆï¼šTCP&#x2F;IP åè®®æ ˆç§»æ¤ä¸å®è·µ</h1><p>åœ¨æ™ºèƒ½æ‰‹æœºåŠŸè€—ä¼˜åŒ–é¢†åŸŸï¼ŒAPï¼ˆApplication Processorï¼Œåº”ç”¨å¤„ç†å™¨ï¼‰çš„ä¼‘çœ å”¤é†’ç­–ç•¥æ˜¯å…³é”®ç¯èŠ‚ã€‚è®¸å¤šåº”ç”¨ï¼ˆå¦‚å³æ—¶é€šè®¯ã€æ¨é€æœåŠ¡ï¼‰ä¾èµ–å‘¨æœŸæ€§å¿ƒè·³åŒ…ç»´æŒç½‘ç»œè¿æ¥ï¼Œè¿™ä¼šå¯¼è‡´ AP é¢‘ç¹ä»æ·±åº¦ä¼‘çœ ä¸­å”¤é†’ï¼Œæ˜¾è‘—å¢åŠ å¾…æœºåŠŸè€—ã€‚æœ¬æ–‡å°†ä»¥ TCP&#x2F;IP åè®®æ ˆä¸ºæŠ€æœ¯åˆ‡å…¥ç‚¹ï¼Œè¯¦ç»†ä»‹ç»ä¸€ç§é€šè¿‡ Modem ä»£ç† AP å¿ƒè·³çš„æ–¹æ¡ˆ â€”â€” åˆ©ç”¨ LwIP è½»é‡çº§åè®®æ ˆåœ¨ Modem ä¾§å®ç° IPv4&#x2F;IPv6 åŒ…è§£æä¸ä»£ç†å›å¤ï¼Œå‡å°‘ AP å”¤é†’æ¬¡æ•°ï¼Œæœ€ç»ˆå®ç°åŠŸè€—ä¼˜åŒ–ã€‚</p>
<h2 id="æ–¹æ¡ˆèƒŒæ™¯ï¼šä¸ºä½•éœ€è¦-Modem-ä»£ç†å¿ƒè·³ï¼Ÿ"><a href="#æ–¹æ¡ˆèƒŒæ™¯ï¼šä¸ºä½•éœ€è¦-Modem-ä»£ç†å¿ƒè·³ï¼Ÿ" class="headerlink" title="æ–¹æ¡ˆèƒŒæ™¯ï¼šä¸ºä½•éœ€è¦ Modem ä»£ç†å¿ƒè·³ï¼Ÿ"></a>æ–¹æ¡ˆèƒŒæ™¯ï¼šä¸ºä½•éœ€è¦ Modem ä»£ç†å¿ƒè·³ï¼Ÿ</h2><p>æ™ºèƒ½æ‰‹æœºçš„ç½‘ç»œè¿æ¥é€šå¸¸ç”± AP å’Œ Modem ååŒç»´æŠ¤ï¼šAP è´Ÿè´£è¿è¡Œåº”ç”¨å±‚é€»è¾‘ï¼ŒModem è´Ÿè´£åº•å±‚ç½‘ç»œæ¥å…¥ï¼ˆå¦‚ 4G&#x2F;5Gã€Wi-Fiï¼‰ã€‚ä¼ ç»Ÿæ¨¡å¼ä¸­ï¼Œå¿ƒè·³åŒ…çš„æ”¶å‘éœ€ç»è¿‡ â€œModem æ¥æ”¶â†’AP å”¤é†’å¤„ç†â†’AP ç”Ÿæˆå›å¤â†’Modem å‘é€â€ å…¨æµç¨‹ï¼Œå³ä½¿ç®€å•çš„å¿ƒè·³å›å¤ä¹Ÿä¼šè§¦å‘ AP ä»æ·±åº¦ä¼‘çœ ï¼ˆå¦‚ Linux çš„ suspend çŠ¶æ€ï¼‰å”¤é†’ï¼Œæ¯æ¬¡å”¤é†’ä¼šå¸¦æ¥æ¯«ç§’çº§çš„ç”µæµå³°å€¼ï¼ˆé€šå¸¸ä» Î¼A çº§è·ƒå‡è‡³ mA çº§ï¼‰ã€‚</p>
<p><strong>æ ¸å¿ƒç—›ç‚¹</strong>ï¼šé«˜é¢‘å¿ƒè·³ï¼ˆå¦‚æ¯ 30 ç§’ä¸€æ¬¡ï¼‰ä¼šå¯¼è‡´ AP æ¯æ—¥å”¤é†’æ•°åƒæ¬¡ï¼Œé¢å¤–æ¶ˆè€— 20-30% çš„å¾…æœºç”µé‡ã€‚</p>
<p><strong>ä¼˜åŒ–æ€è·¯</strong>ï¼šModem æœ¬èº«éœ€æŒç»­ç»´æŒç½‘ç»œè¿æ¥ï¼ˆæ— æ³•æ·±åº¦ä¼‘çœ ï¼‰ï¼Œå¯ç”± Modem ç›´æ¥è§£æå¿ƒè·³åŒ…å¹¶ç”Ÿæˆå›å¤ï¼Œæ— éœ€å”¤é†’ APã€‚è¿™è¦æ±‚ Modem å…·å¤‡ TCP&#x2F;IP åè®®è§£æèƒ½åŠ› â€”â€”LwIP è½»é‡çº§åè®®æ ˆå› å…¶ä½“ç§¯å°ã€èµ„æºå ç”¨ä½ï¼ˆRAM éœ€æ±‚å¯ä½è‡³å‡ å KBï¼‰ï¼Œæˆä¸º Modem ä¾§çš„ç†æƒ³é€‰æ‹©ã€‚</p>
<h2 id="LwIP-åè®®æ ˆï¼šè½»é‡çº§-TCP-IP-è§£å†³æ–¹æ¡ˆ"><a href="#LwIP-åè®®æ ˆï¼šè½»é‡çº§-TCP-IP-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="LwIP åè®®æ ˆï¼šè½»é‡çº§ TCP&#x2F;IP è§£å†³æ–¹æ¡ˆ"></a>LwIP åè®®æ ˆï¼šè½»é‡çº§ TCP&#x2F;IP è§£å†³æ–¹æ¡ˆ</h2><p>LwIPï¼ˆLightweight IPï¼‰æ˜¯ç‘å…¸è®¡ç®—æœºç§‘å­¦ç ”ç©¶æ‰€å¼€å‘çš„å¼€æº TCP&#x2F;IP åè®®æ ˆï¼Œä¸“ä¸ºåµŒå…¥å¼ç³»ç»Ÿè®¾è®¡ï¼Œæ”¯æŒ IPv4ã€IPv6ã€TCPã€UDPã€ICMP ç­‰æ ¸å¿ƒåè®®ï¼ŒåŒæ—¶æä¾›äº† RAW&#x2F;APIã€NETCONN&#x2F;API å’Œ Socket&#x2F;API ä¸‰ç§ç¼–ç¨‹æ¥å£ï¼Œå…¼é¡¾è½»é‡æ€§ä¸æ˜“ç”¨æ€§ã€‚</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><p>èµ„æºå ç”¨ä½ï¼šæœ€å°é…ç½®ä¸‹ RAM ä»…éœ€ 40KBï¼ŒROM çº¦ 60KBï¼Œé€‚åˆ Modem ç­‰èµ„æºå—é™åœºæ™¯ï¼›</p>
</li>
<li><p>å¯è£å‰ªæ€§ï¼šé€šè¿‡<code>lwipopts.h</code>é…ç½®æ–‡ä»¶æ”¯æŒåŠŸèƒ½æ¨¡å—åŒ–è£å‰ªï¼ˆå¦‚ä»…ä¿ç•™ IPv4+UDP æˆ– IPv6+TCPï¼‰ï¼›</p>
</li>
<li><p>ç§»æ¤æ€§å¼ºï¼šä¸ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„è€¦åˆé€šè¿‡æŠ½è±¡å±‚å®ç°ï¼Œé€‚é…å„ç±»å¤„ç†å™¨å’Œ RTOSã€‚</p>
</li>
</ul>
<h2 id="LwIP-ç§»æ¤åˆ°-Modem-çš„å…³é”®æ­¥éª¤"><a href="#LwIP-ç§»æ¤åˆ°-Modem-çš„å…³é”®æ­¥éª¤" class="headerlink" title="LwIP ç§»æ¤åˆ° Modem çš„å…³é”®æ­¥éª¤"></a>LwIP ç§»æ¤åˆ° Modem çš„å…³é”®æ­¥éª¤</h2><p>Modem é€šå¸¸åŸºäºä¸“ç”¨é€šä¿¡èŠ¯ç‰‡ï¼ˆå¦‚é«˜é€š MDM ç³»åˆ—ã€è”å‘ç§‘ MT62 ç³»åˆ—ï¼‰ï¼Œè¿è¡Œå®æ—¶æ“ä½œç³»ç»Ÿï¼ˆå¦‚ RTOSã€ThreadXï¼‰ã€‚å°† LwIP ç§»æ¤åˆ° Modem éœ€å®Œæˆä»¥ä¸‹æ ¸å¿ƒå·¥ä½œï¼š</p>
<h3 id="1-ç¡¬ä»¶é€‚é…ï¼šç½‘ç»œæ¥å£é©±åŠ¨å®ç°"><a href="#1-ç¡¬ä»¶é€‚é…ï¼šç½‘ç»œæ¥å£é©±åŠ¨å®ç°" class="headerlink" title="1. ç¡¬ä»¶é€‚é…ï¼šç½‘ç»œæ¥å£é©±åŠ¨å®ç°"></a>1. ç¡¬ä»¶é€‚é…ï¼šç½‘ç»œæ¥å£é©±åŠ¨å®ç°</h3><p>LwIP é€šè¿‡<code>netif</code>ç»“æ„ä½“ç®¡ç†ç½‘ç»œæ¥å£ï¼Œéœ€ä¸º Modem çš„ç½‘ç»œç¡¬ä»¶ï¼ˆå¦‚åŸºå¸¦èŠ¯ç‰‡çš„ MAC æ¥å£ï¼‰å®ç°æ•°æ®æ”¶å‘é©±åŠ¨ã€‚</p>
<p><strong>å…³é”®æ¥å£</strong>ï¼š</p>
<ul>
<li><p><code>low_level_init()</code>ï¼šåˆå§‹åŒ–ç¡¬ä»¶ï¼ˆå¦‚é…ç½® PHYã€è®¾ç½® MAC åœ°å€ã€ä½¿èƒ½ä¸­æ–­ï¼‰ï¼›</p>
</li>
<li><p><code>low_level_output()</code>ï¼šå°† LwIP å°è£…çš„æ•°æ®åŒ…å‘é€åˆ°ç‰©ç†å±‚ï¼›</p>
</li>
<li><p><code>low_level_input()</code>ï¼šä»ç‰©ç†å±‚æ¥æ”¶æ•°æ®åŒ…å¹¶æäº¤ç»™ LwIP åè®®æ ˆã€‚</p>
</li>
</ul>
<p><strong>ç¤ºä¾‹ä»£ç æ¡†æ¶</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰ç½‘ç»œæ¥å£ç»“æ„ä½“</span><br><span class="line"></span><br><span class="line">struct netif modem\_netif;</span><br><span class="line"></span><br><span class="line">// ç¡¬ä»¶åˆå§‹åŒ–å‡½æ•°</span><br><span class="line"></span><br><span class="line">static err\_t low\_level\_init(struct netif \*netif) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif-&gt;hwaddr\_len = 6;                  // MACåœ°å€é•¿åº¦</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif-&gt;hwaddr\[0] = 0x00;                // é…ç½®Modemçš„MACåœ°å€</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif-&gt;hwaddr\[1] = 0x1A;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // ... å…¶ä»–MACåœ°å€å­—èŠ‚</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif-&gt;mtu = 1500;                      // æœ€å¤§ä¼ è¾“å•å…ƒ</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif-&gt;flags = NETIF\_FLAG\_BROADCAST | NETIF\_FLAG\_ETHARP; // ä½¿èƒ½å¹¿æ’­å’ŒARP</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆå§‹åŒ–ModemåŸºå¸¦çš„MACæ§åˆ¶å™¨</span><br><span class="line"></span><br><span class="line">&amp;#x20; modem\_mac\_init();</span><br><span class="line"></span><br><span class="line">&amp;#x20; return ERR\_OK;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å‘é€å‡½æ•°</span><br><span class="line"></span><br><span class="line">static err\_t low\_level\_output(struct netif \*netif, struct pbuf \*p) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // å°†pbufé“¾ä¸­çš„æ•°æ®æ‹·è´åˆ°Modemçš„å‘é€ç¼“å†²åŒº</span><br><span class="line"></span><br><span class="line">&amp;#x20; uint8\_t \*buf = modem\_get\_tx\_buf(p-&gt;tot\_len);</span><br><span class="line"></span><br><span class="line">&amp;#x20; pbuf\_copy\_partial(p, buf, p-&gt;tot\_len, 0);</span><br><span class="line"></span><br><span class="line">&amp;#x20; // è§¦å‘ç¡¬ä»¶å‘é€</span><br><span class="line"></span><br><span class="line">&amp;#x20; modem\_mac\_send(buf, p-&gt;tot\_len);</span><br><span class="line"></span><br><span class="line">&amp;#x20; return ERR\_OK;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ¥æ”¶ä¸­æ–­å¤„ç†å‡½æ•°ï¼ˆç¡¬ä»¶è§¦å‘ï¼‰</span><br><span class="line"></span><br><span class="line">void modem\_mac\_rx\_irq(void) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; uint32\_t len = modem\_get\_rx\_len();</span><br><span class="line"></span><br><span class="line">&amp;#x20; uint8\_t \*buf = modem\_get\_rx\_buf();</span><br><span class="line"></span><br><span class="line">&amp;#x20; // å°†æ¥æ”¶æ•°æ®å°è£…ä¸ºpbuf</span><br><span class="line"></span><br><span class="line">&amp;#x20; struct pbuf \*p = pbuf\_alloc(PBUF\_RAW, len, PBUF\_POOL);</span><br><span class="line"></span><br><span class="line">&amp;#x20; if (p != NULL) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   pbuf\_take(p, buf, len);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // æäº¤ç»™LwIPåè®®æ ˆ</span><br><span class="line"></span><br><span class="line">&amp;#x20;   netif-&gt;input(p, netif);</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125;</span><br><span class="line"></span><br><span class="line">&amp;#x20; modem\_release\_rx\_buf();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-æ“ä½œç³»ç»Ÿé€‚é…ï¼šsys-arch-å±‚å®ç°"><a href="#2-æ“ä½œç³»ç»Ÿé€‚é…ï¼šsys-arch-å±‚å®ç°" class="headerlink" title="2. æ“ä½œç³»ç»Ÿé€‚é…ï¼šsys_arch å±‚å®ç°"></a>2. æ“ä½œç³»ç»Ÿé€‚é…ï¼šsys_arch å±‚å®ç°</h3><p>LwIP ä¾èµ–æ“ä½œç³»ç»Ÿæä¾›çš„çº¿ç¨‹ã€ä¿¡å·é‡ã€é‚®ç®±ç­‰åŸºç¡€æœåŠ¡ï¼Œéœ€å®ç°<code>sys_arch.h</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ¥å£ï¼ˆä»¥ ThreadX ä¸ºä¾‹ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>LwIP æ¥å£</th>
<th>ThreadX å®ç°</th>
<th>åŠŸèƒ½è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>sys_mutex_t</code></td>
<td><code>TX_MUTEX</code></td>
<td>äº’æ–¥é”ï¼Œä¿æŠ¤å…±äº«èµ„æº</td>
</tr>
<tr>
<td><code>sys_sem_t</code></td>
<td><code>TX_SEMAPHORE</code></td>
<td>ä¿¡å·é‡ï¼Œç”¨äºåŒæ­¥æ“ä½œ</td>
</tr>
<tr>
<td><code>sys_mbox_t</code></td>
<td><code>TX_QUEUE</code></td>
<td>é‚®ç®±ï¼Œç”¨äºçº¿ç¨‹é—´æ¶ˆæ¯ä¼ é€’</td>
</tr>
<tr>
<td><code>sys_thread_new</code></td>
<td><code>tx_thread_create</code></td>
<td>åˆ›å»ºåè®®æ ˆå¤„ç†çº¿ç¨‹</td>
</tr>
</tbody></table>
<p><strong>ç¤ºä¾‹ï¼šä¿¡å·é‡å®ç°</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// åˆ›å»ºä¿¡å·é‡</span><br><span class="line"></span><br><span class="line">sys\_sem\_t sys\_sem\_new(uint8\_t count) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; TX\_SEMAPHORE \*sem = (TX\_SEMAPHORE \*)modem\_malloc(sizeof(TX\_SEMAPHORE));</span><br><span class="line"></span><br><span class="line">&amp;#x20; tx\_semaphore\_create(sem, &quot;lwip\_sem&quot;, count);</span><br><span class="line"></span><br><span class="line">&amp;#x20; return (sys\_sem\_t)sem;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç­‰å¾…ä¿¡å·é‡</span><br><span class="line"></span><br><span class="line">err\_t sys\_sem\_wait(sys\_sem\_t sem, uint32\_t timeout) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; UINT ret = tx\_semaphore\_get((TX\_SEMAPHORE \*)sem,&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20;                            timeout == 0 ? TX\_NO\_WAIT : timeout);</span><br><span class="line"></span><br><span class="line">&amp;#x20; return (ret == TX\_SUCCESS) ? ERR\_OK : ERR\_TIMEOUT;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-åè®®æ ˆé…ç½®ï¼šåŠŸèƒ½è£å‰ªä¸å‚æ•°ä¼˜åŒ–"><a href="#3-åè®®æ ˆé…ç½®ï¼šåŠŸèƒ½è£å‰ªä¸å‚æ•°ä¼˜åŒ–" class="headerlink" title="3. åè®®æ ˆé…ç½®ï¼šåŠŸèƒ½è£å‰ªä¸å‚æ•°ä¼˜åŒ–"></a>3. åè®®æ ˆé…ç½®ï¼šåŠŸèƒ½è£å‰ªä¸å‚æ•°ä¼˜åŒ–</h3><p>é€šè¿‡<code>lwipopts.h</code>é…ç½®æ–‡ä»¶è£å‰ª LwIP åŠŸèƒ½ï¼Œä»…ä¿ç•™å¿ƒè·³ä»£ç†æ‰€éœ€æ¨¡å—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿èƒ½IPv4å’ŒIPv6</span><br><span class="line"></span><br><span class="line">\#define LWIP\_IPV4 1</span><br><span class="line"></span><br><span class="line">\#define LWIP\_IPV6 1</span><br><span class="line"></span><br><span class="line">// ä½¿èƒ½TCPå’ŒUDPï¼ˆå¿ƒè·³åŒ…é€šå¸¸åŸºäºè¿™ä¸¤ç§åè®®ï¼‰</span><br><span class="line"></span><br><span class="line">\#define LWIP\_TCP 1</span><br><span class="line"></span><br><span class="line">\#define LWIP\_UDP 1</span><br><span class="line"></span><br><span class="line">// å…³é—­ä¸éœ€è¦çš„åŠŸèƒ½ï¼ˆå¦‚DHCPã€DNSï¼ŒModemé€šå¸¸é€šè¿‡ATæŒ‡ä»¤è·å–ç½‘ç»œé…ç½®ï¼‰</span><br><span class="line"></span><br><span class="line">\#define LWIP\_DHCP 0</span><br><span class="line"></span><br><span class="line">\#define LWIP\_DNS 0</span><br><span class="line"></span><br><span class="line">// ä¼˜åŒ–å†…å­˜é…ç½®ï¼ˆæ ¹æ®Modem RAMå¤§å°è°ƒæ•´ï¼‰</span><br><span class="line"></span><br><span class="line">\#define MEM\_SIZE 65536                  // å†…å­˜æ± å¤§å°ï¼š64KB</span><br><span class="line"></span><br><span class="line">\#define MEMP\_NUM\_NETIF 1                // ä»…éœ€1ä¸ªç½‘ç»œæ¥å£</span><br><span class="line"></span><br><span class="line">\#define MEMP\_NUM\_TCP\_PCB 4              // æœ€å¤šåŒæ—¶å¤„ç†4ä¸ªTCPè¿æ¥</span><br><span class="line"></span><br><span class="line">\#define MEMP\_NUM\_UDP\_PCB 8              // æœ€å¤šåŒæ—¶å¤„ç†8ä¸ªUDPè¿æ¥</span><br><span class="line"></span><br><span class="line">\#define TCP\_WND 2048                    // TCPçª—å£å¤§å°ï¼š2KB</span><br><span class="line"></span><br><span class="line">\#define TCP\_MSS 1460                    // TCPæœ€å¤§åˆ†æ®µå¤§å°</span><br></pre></td></tr></table></figure>

<h3 id="4-åˆå§‹åŒ–æµç¨‹ï¼šåè®®æ ˆå¯åŠ¨ä¸ç½‘ç»œé…ç½®"><a href="#4-åˆå§‹åŒ–æµç¨‹ï¼šåè®®æ ˆå¯åŠ¨ä¸ç½‘ç»œé…ç½®" class="headerlink" title="4. åˆå§‹åŒ–æµç¨‹ï¼šåè®®æ ˆå¯åŠ¨ä¸ç½‘ç»œé…ç½®"></a>4. åˆå§‹åŒ–æµç¨‹ï¼šåè®®æ ˆå¯åŠ¨ä¸ç½‘ç»œé…ç½®</h3><p>å®Œæˆé€‚é…åï¼Œéœ€åœ¨ Modem å¯åŠ¨æ—¶åˆå§‹åŒ– LwIP å¹¶é…ç½®ç½‘ç»œå‚æ•°ï¼ˆIP åœ°å€ã€ç½‘å…³ç­‰ï¼Œé€šå¸¸ä» AP æˆ–åŸºç«™è·å–ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">void lwip\_modem\_init(void) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆå§‹åŒ–LwIPæ ¸å¿ƒæ¨¡å—</span><br><span class="line"></span><br><span class="line">&amp;#x20; lwip\_init();</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆå§‹åŒ–ç½‘ç»œæ¥å£</span><br><span class="line"></span><br><span class="line">&amp;#x20; ip4\_addr\_t ipaddr, netmask, gw;</span><br><span class="line"></span><br><span class="line">&amp;#x20; IP4\_ADDR(\&amp;ipaddr, 192, 168, 1, 2);    // Modemçš„IPv4åœ°å€</span><br><span class="line"></span><br><span class="line">&amp;#x20; IP4\_ADDR(\&amp;netmask, 255, 255, 255, 0); // å­ç½‘æ©ç </span><br><span class="line"></span><br><span class="line">&amp;#x20; IP4\_ADDR(\&amp;gw, 192, 168, 1, 1);        // ç½‘å…³åœ°å€</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif\_add(\&amp;modem\_netif, \&amp;ipaddr, \&amp;netmask, \&amp;gw,&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20;          NULL, low\_level\_init, ethernet\_input);</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // ä½¿èƒ½ç½‘ç»œæ¥å£</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif\_set\_default(\&amp;modem\_netif);</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif\_set\_up(\&amp;modem\_netif);</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆ›å»ºLwIPå¤„ç†çº¿ç¨‹ï¼ˆä¼˜å…ˆçº§ä½äºModemæ ¸å¿ƒé€šä¿¡ä»»åŠ¡ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; tx\_thread\_create(\&amp;lwip\_thread, &quot;lwip\_thread&quot;,&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20;                 lwip\_process, NULL,</span><br><span class="line"></span><br><span class="line">&amp;#x20;                 lwip\_thread\_stack, LWIP\_THREAD\_STACK\_SIZE,</span><br><span class="line"></span><br><span class="line">&amp;#x20;                 10, 10, TX\_NO\_TIME\_SLICE, TX\_AUTO\_START);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// LwIPå¤„ç†çº¿ç¨‹ï¼ˆå¾ªç¯å¤„ç†åè®®æ ˆäº‹ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line">void lwip\_process(ULONG param) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; while (1) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // å¤„ç†TCPå®šæ—¶å™¨äº‹ä»¶ï¼ˆå¦‚é‡ä¼ ã€è¶…æ—¶ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20;   tcp\_tmr();</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // å¤„ç†IPå®šæ—¶å™¨äº‹ä»¶ï¼ˆå¦‚åˆ†ç‰‡è¶…æ—¶ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20;   ip\_reass\_tmr();</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // å»¶è¿Ÿ10msï¼ˆå¹³è¡¡å®æ—¶æ€§ä¸CPUå ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20;   tx\_thread\_sleep(10);</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¿ƒè·³ä»£ç†æ ¸å¿ƒé€»è¾‘ï¼šåŒ…è§£æä¸ä»£ç†å›å¤"><a href="#å¿ƒè·³ä»£ç†æ ¸å¿ƒé€»è¾‘ï¼šåŒ…è§£æä¸ä»£ç†å›å¤" class="headerlink" title="å¿ƒè·³ä»£ç†æ ¸å¿ƒé€»è¾‘ï¼šåŒ…è§£æä¸ä»£ç†å›å¤"></a>å¿ƒè·³ä»£ç†æ ¸å¿ƒé€»è¾‘ï¼šåŒ…è§£æä¸ä»£ç†å›å¤</h2><p>Modem ä»£ç† AP å¿ƒè·³çš„æ ¸å¿ƒæ˜¯è¯†åˆ« AP çš„å¿ƒè·³åŒ…ç‰¹å¾ï¼ˆå¦‚ç›®çš„ IPã€ç«¯å£ã€ payload æ ¼å¼ï¼‰ï¼Œåœ¨ AP ä¼‘çœ æ—¶ç›´æ¥ç”Ÿæˆå›å¤åŒ…ï¼Œé¿å…å”¤é†’ APã€‚</p>
<h3 id="1-æ•°æ®åŒ…æ•è·ä¸è§£æ"><a href="#1-æ•°æ®åŒ…æ•è·ä¸è§£æ" class="headerlink" title="1. æ•°æ®åŒ…æ•è·ä¸è§£æ"></a>1. æ•°æ®åŒ…æ•è·ä¸è§£æ</h3><p>LwIP é€šè¿‡<code>netif-&gt;input</code>å‡½æ•°æ¥æ”¶æ•°æ®åŒ…ï¼Œéœ€åœ¨åè®®æ ˆå¤„ç†å‰æ’å…¥é’©å­å‡½æ•°ï¼Œè¿‡æ»¤å¹¶è§£æå¿ƒè·³åŒ…ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">// è‡ªå®šä¹‰è¾“å…¥å‡½æ•°ï¼ˆæ›¿ä»£é»˜è®¤çš„ethernet\_inputï¼‰</span><br><span class="line"></span><br><span class="line">err\_t custom\_ethernet\_input(struct pbuf \*p, struct netif \*netif) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; struct eth\_hdr \*ethhdr = pbuf\_header(p, -PBUF\_IP\_HLEN); // è·å–ä»¥å¤ªç½‘å¤´éƒ¨</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆ¤æ–­åè®®ç±»å‹ï¼ˆIPv4æˆ–IPv6ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; if (ntohs(ethhdr-&gt;type) == ETHTYPE\_IP) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // è§£æIPv4åŒ…</span><br><span class="line"></span><br><span class="line">&amp;#x20;   struct ip\_hdr \*iphdr = (struct ip\_hdr \*)p-&gt;payload;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if (iphdr-&gt;version == 4) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;     handle\_ipv4\_packet(p, iphdr);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   &#125;</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125; else if (ntohs(ethhdr-&gt;type) == ETHTYPE\_IPV6) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // è§£æIPv6åŒ…</span><br><span class="line"></span><br><span class="line">&amp;#x20;   struct ip6\_hdr \*ip6hdr = (struct ip6\_hdr \*)p-&gt;payload;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   handle\_ipv6\_packet(p, ip6hdr);</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125;</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // è‹¥ä¸æ˜¯å¿ƒè·³åŒ…ï¼Œäº¤ç»™LwIPæ­£å¸¸å¤„ç†ï¼ˆå¦‚è½¬å‘ç»™APï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; return ethernet\_input(p, netif);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// IPv4åŒ…å¤„ç†å‡½æ•°</span><br><span class="line"></span><br><span class="line">void handle\_ipv4\_packet(struct pbuf \*p, struct ip\_hdr \*iphdr) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; uint16\_t src\_port, dst\_port;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆ¤æ–­ä¼ è¾“å±‚åè®®ï¼ˆTCP/UDPï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; if (iphdr-&gt;protocol == IP\_PROTO\_TCP) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   struct tcp\_hdr \*tcphdr = (struct tcp\_hdr \*)((uint8\_t \*)iphdr + IPH\_HL(iphdr)\*4);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   src\_port = ntohs(tcphdr-&gt;src);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   dst\_port = ntohs(tcphdr-&gt;dest);</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125; else if (iphdr-&gt;protocol == IP\_PROTO\_UDP) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   struct udp\_hdr \*udphdr = (struct udp\_hdr \*)((uint8\_t \*)iphdr + IPH\_HL(iphdr)\*4);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   src\_port = ntohs(udphdr-&gt;src);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   dst\_port = ntohs(udphdr-&gt;dest);</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125;</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åŒ¹é…å¿ƒè·³åŒ…ç‰¹å¾ï¼ˆä¾‹å¦‚ï¼šç›®çš„IPä¸ºæ¨é€æœåŠ¡å™¨ï¼Œç«¯å£ä¸º8080ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; if (ip4\_addr\_cmp(\&amp;iphdr-&gt;dest, \&amp;push\_server\_ipv4) &amp;&amp; dst\_port == 8080) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // æ£€æŸ¥APæ˜¯å¦å¤„äºä¼‘çœ çŠ¶æ€</span><br><span class="line"></span><br><span class="line">&amp;#x20;   if (ap\_is\_sleeping()) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;     // ä»£ç†å›å¤å¿ƒè·³åŒ…</span><br><span class="line"></span><br><span class="line">&amp;#x20;     proxy\_heartbeat\_reply(p, iphdr);</span><br><span class="line"></span><br><span class="line">&amp;#x20;     pbuf\_free(p); // å·²å¤„ç†ï¼Œé‡Šæ”¾pbuf</span><br><span class="line"></span><br><span class="line">&amp;#x20;     return;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   &#125;</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-ä»£ç†å›å¤åŒ…ç”Ÿæˆ"><a href="#2-ä»£ç†å›å¤åŒ…ç”Ÿæˆ" class="headerlink" title="2. ä»£ç†å›å¤åŒ…ç”Ÿæˆ"></a>2. ä»£ç†å›å¤åŒ…ç”Ÿæˆ</h3><p>ç”Ÿæˆå›å¤åŒ…æ—¶éœ€äº¤æ¢æº &#x2F; ç›®çš„åœ°å€å’Œç«¯å£ï¼Œå¹¶ä¿æŒåº”ç”¨å±‚ payload æ ¼å¼ä¸€è‡´ï¼ˆå¦‚å›å£°å›å¤æˆ–å›ºå®šæ ¼å¼åº”ç­”ï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">void proxy\_heartbeat\_reply(struct pbuf \*req\_p, struct ip\_hdr \*req\_iphdr) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // åˆ†é…å›å¤åŒ…ç¼“å†²åŒº</span><br><span class="line"></span><br><span class="line">&amp;#x20; struct pbuf \*resp\_p = pbuf\_alloc(PBUF\_RAW, req\_p-&gt;tot\_len, PBUF\_POOL);</span><br><span class="line"></span><br><span class="line">&amp;#x20; if (resp\_p == NULL) return;</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // å¤åˆ¶å¹¶ä¿®æ”¹IPå¤´éƒ¨ï¼ˆäº¤æ¢æº/ç›®çš„IPï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; struct ip\_hdr \*resp\_iphdr = (struct ip\_hdr \*)resp\_p-&gt;payload;</span><br><span class="line"></span><br><span class="line">&amp;#x20; memcpy(resp\_iphdr, req\_iphdr, IPH\_HL(req\_iphdr)\*4);</span><br><span class="line"></span><br><span class="line">&amp;#x20; ip4\_addr\_copy(resp\_iphdr-&gt;src, req\_iphdr-&gt;dest);</span><br><span class="line"></span><br><span class="line">&amp;#x20; ip4\_addr\_copy(resp\_iphdr-&gt;dest, req\_iphdr-&gt;src);</span><br><span class="line"></span><br><span class="line">&amp;#x20; resp\_iphdr-&gt;ttl = 64; // é‡ç½®TTL</span><br><span class="line"></span><br><span class="line">&amp;#x20; resp\_iphdr-&gt;checksum = 0;</span><br><span class="line"></span><br><span class="line">&amp;#x20; resp\_iphdr-&gt;checksum = inet\_chksum(resp\_iphdr, IPH\_HL(resp\_iphdr)\*4);</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // ä¿®æ”¹ä¼ è¾“å±‚å¤´éƒ¨ï¼ˆäº¤æ¢æº/ç›®çš„ç«¯å£ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; if (req\_iphdr-&gt;protocol == IP\_PROTO\_TCP) &#123;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   struct tcp\_hdr \*req\_tcphdr = (struct tcp\_hdr \*)((uint8\_t \*)req\_iphdr + IPH\_HL(req\_iphdr)\*4);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   struct tcp\_hdr \*resp\_tcphdr = (struct tcp\_hdr \*)((uint8\_t \*)resp\_iphdr + IPH\_HL(resp\_iphdr)\*4);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   memcpy(resp\_tcphdr, req\_tcphdr, sizeof(struct tcp\_hdr));</span><br><span class="line"></span><br><span class="line">&amp;#x20;   resp\_tcphdr-&gt;src = req\_tcphdr-&gt;dest;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   resp\_tcphdr-&gt;dest = req\_tcphdr-&gt;src;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   resp\_tcphdr-&gt;seq = htonl(ntohl(req\_tcphdr-&gt;ackno)); // è°ƒæ•´åºåˆ—å·</span><br><span class="line"></span><br><span class="line">&amp;#x20;   resp\_tcphdr-&gt;ackno = htonl(ntohl(req\_tcphdr-&gt;seq) + req\_tcphdr-&gt;syn + req\_tcphdr-&gt;fin + pbuf\_len(req\_p) - IPH\_HL(req\_iphdr)\*4 - TCP\_HLEN);</span><br><span class="line"></span><br><span class="line">&amp;#x20;   resp\_tcphdr-&gt;checksum = 0;</span><br><span class="line"></span><br><span class="line">&amp;#x20;   // è®¡ç®—TCPæ ¡éªŒå’Œï¼ˆåŒ…å«ä¼ªå¤´éƒ¨ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20;   resp\_tcphdr-&gt;checksum = tcp\_chksum(resp\_p, \&amp;resp\_iphdr-&gt;src, \&amp;resp\_iphdr-&gt;dest);</span><br><span class="line"></span><br><span class="line">&amp;#x20; &#125;</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // å¤åˆ¶åº”ç”¨å±‚payloadï¼ˆä¿æŒä¸å˜ï¼‰</span><br><span class="line"></span><br><span class="line">&amp;#x20; uint8\_t \*req\_payload = (uint8\_t \*)req\_iphdr + IPH\_HL(req\_iphdr)\*4 + (req\_iphdr-&gt;protocol == IP\_PROTO\_TCP ? TCP\_HLEN : UDP\_HLEN);</span><br><span class="line"></span><br><span class="line">&amp;#x20; uint8\_t \*resp\_payload = (uint8\_t \*)resp\_iphdr + IPH\_HL(resp\_iphdr)\*4 + (resp\_iphdr-&gt;protocol == IP\_PROTO\_TCP ? TCP\_HLEN : UDP\_HLEN);</span><br><span class="line"></span><br><span class="line">&amp;#x20; memcpy(resp\_payload, req\_payload, pbuf\_len(req\_p) - IPH\_HL(req\_iphdr)\*4 - (req\_iphdr-&gt;protocol == IP\_PROTO\_TCP ? TCP\_HLEN : UDP\_HLEN));</span><br><span class="line"></span><br><span class="line">&amp;#x20;&amp;#x20;</span><br><span class="line"></span><br><span class="line">&amp;#x20; // å‘é€å›å¤åŒ…</span><br><span class="line"></span><br><span class="line">&amp;#x20; netif-&gt;output(netif, resp\_p, \&amp;resp\_iphdr-&gt;dest);</span><br><span class="line"></span><br><span class="line">&amp;#x20; pbuf\_free(resp\_p);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-ä¸-AP-çš„ååŒæœºåˆ¶"><a href="#3-ä¸-AP-çš„ååŒæœºåˆ¶" class="headerlink" title="3. ä¸ AP çš„ååŒæœºåˆ¶"></a>3. ä¸ AP çš„ååŒæœºåˆ¶</h3><p>ä¸ºé¿å…ä»£ç†é€»è¾‘ä¸ AP å”¤é†’åçš„æ•°æ®å¤„ç†å†²çªï¼Œéœ€è®¾è®¡ç®€å•çš„åŒæ­¥æœºåˆ¶ï¼š</p>
<ul>
<li><p>AP ä¼‘çœ å‰ï¼Œé€šè¿‡å…±äº«å†…å­˜å‘ŠçŸ¥ Modem å½“å‰æ´»è·ƒçš„å¿ƒè·³è¿æ¥ï¼ˆIPã€ç«¯å£ã€åè®®ï¼‰ï¼›</p>
</li>
<li><p>AP å”¤é†’æ—¶ï¼ŒModem åœæ­¢ä»£ç†å¹¶å°†ç¼“å­˜çš„éå¿ƒè·³æ•°æ®è½¬å‘ç»™ APï¼›</p>
</li>
<li><p>ä»£ç†è¿‡ç¨‹ä¸­è‹¥æ£€æµ‹åˆ°å¼‚å¸¸åŒ…ï¼ˆå¦‚è¿æ¥å…³é—­ï¼‰ï¼ŒåŠæ—¶é€šçŸ¥ AP å¤„ç†ã€‚</p>
</li>
</ul>
<h2 id="æµ‹è¯•ä¸ä¼˜åŒ–ï¼šåŠŸè€—ä¸ç¨³å®šæ€§éªŒè¯"><a href="#æµ‹è¯•ä¸ä¼˜åŒ–ï¼šåŠŸè€—ä¸ç¨³å®šæ€§éªŒè¯" class="headerlink" title="æµ‹è¯•ä¸ä¼˜åŒ–ï¼šåŠŸè€—ä¸ç¨³å®šæ€§éªŒè¯"></a>æµ‹è¯•ä¸ä¼˜åŒ–ï¼šåŠŸè€—ä¸ç¨³å®šæ€§éªŒè¯</h2><h3 id="åŠŸè€—å¯¹æ¯”æµ‹è¯•"><a href="#åŠŸè€—å¯¹æ¯”æµ‹è¯•" class="headerlink" title="åŠŸè€—å¯¹æ¯”æµ‹è¯•"></a>åŠŸè€—å¯¹æ¯”æµ‹è¯•</h3><p>åœ¨æŸæ¬¾ 4G æ‰‹æœºä¸Šçš„æµ‹è¯•æ•°æ®æ˜¾ç¤ºï¼š</p>
<ul>
<li><p>ä¼ ç»Ÿæ–¹æ¡ˆï¼šAP æ¯æ—¥å› å¿ƒè·³å”¤é†’çº¦ 2880 æ¬¡ï¼ˆæ¯ 30 ç§’ä¸€æ¬¡ï¼‰ï¼Œå¾…æœºç”µæµå¹³å‡ 12mAï¼›</p>
</li>
<li><p>ä»£ç†æ–¹æ¡ˆï¼šAP æ¯æ—¥å”¤é†’æ¬¡æ•°é™è‡³â‰¤100 æ¬¡ï¼ˆä»…å¤„ç†éä»£ç†æ•°æ®ï¼‰ï¼Œå¾…æœºç”µæµé™è‡³ 7mAï¼ŒåŠŸè€—é™ä½çº¦ 41.7%ã€‚</p>
</li>
</ul>
<h3 id="ç¨³å®šæ€§ä¼˜åŒ–"><a href="#ç¨³å®šæ€§ä¼˜åŒ–" class="headerlink" title="ç¨³å®šæ€§ä¼˜åŒ–"></a>ç¨³å®šæ€§ä¼˜åŒ–</h3><ul>
<li><p><strong>åŒ…è§£æå®¹é”™</strong>ï¼šå¢åŠ å¯¹ç•¸å½¢åŒ…ï¼ˆå¦‚é•¿åº¦å¼‚å¸¸ã€æ ¡éªŒå’Œé”™è¯¯ï¼‰çš„è¿‡æ»¤ï¼Œé¿å… Modem å¼‚å¸¸ï¼›</p>
</li>
<li><p><strong>è¿æ¥çŠ¶æ€åŒæ­¥</strong>ï¼šå®šæœŸä¸ AP åŒæ­¥ TCP è¿æ¥çŠ¶æ€ï¼ˆå¦‚çª—å£å¤§å°ã€åºåˆ—å·ï¼‰ï¼Œé˜²æ­¢ä»£ç†å›å¤å¯¼è‡´è¿æ¥ä¸­æ–­ï¼›</p>
</li>
<li><p><strong>èµ„æºç›‘æ§</strong>ï¼šåœ¨ LwIP ä¸­å¢åŠ å†…å­˜æ± ä½¿ç”¨ç‡ç›‘æ§ï¼Œé¿å…å†…å­˜æ³„æ¼å¯¼è‡´ Modem é‡å¯ã€‚</p>
</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é€šè¿‡å°† LwIP åè®®æ ˆç§»æ¤åˆ° Modemï¼Œå®ç°å¿ƒè·³åŒ…çš„ä»£ç†å›å¤ï¼Œæ˜¯ä¸€ç§ä½æˆæœ¬ã€é«˜æ”¶ç›Šçš„åŠŸè€—ä¼˜åŒ–æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆçš„æ ¸å¿ƒåœ¨äºåˆ©ç”¨ LwIP çš„è½»é‡æ€§é€‚é… Modem èµ„æºçº¦æŸï¼Œé€šè¿‡ç²¾å‡†çš„åŒ…è§£æä¸ä»£ç†é€»è¾‘å‡å°‘ AP å”¤é†’ã€‚å®é™…åº”ç”¨ä¸­ï¼Œéœ€æ ¹æ®å…·ä½“å¿ƒè·³åè®®ï¼ˆå¦‚ MQTTã€XMPPï¼‰ä¼˜åŒ–ç‰¹å¾åŒ¹é…è§„åˆ™ï¼Œå¹¶é€šè¿‡ä¸¥æ ¼çš„å…¼å®¹æ€§æµ‹è¯•ç¡®ä¿ä¸å½±å“ä¸Šå±‚åº”ç”¨ä½“éªŒã€‚</p>
<p>æœªæ¥å¯è¿›ä¸€æ­¥æ‰©å±•è¯¥æ–¹æ¡ˆï¼Œæ”¯æŒæ›´å¤æ‚çš„åº”ç”¨å±‚åè®®ä»£ç†ï¼ˆå¦‚ HTTP çŸ­è¿æ¥ï¼‰ï¼Œæˆ–å°† LwIP ä¸ Modem çš„åŸºå¸¦åè®®æ ˆæ·±åº¦èåˆï¼Œå®ç°æ›´ç²¾ç»†åŒ–çš„ç½‘ç»œæ•°æ®åˆ†æµã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://walking9.github.io/2021/12/05/Modem%E4%BB%A3%E7%90%86AP%E5%BF%83%E8%B7%B3%E6%96%B9%E6%A1%88/" data-id="cmdxay89g000sm7mk436s7bp4" data-title="Modemä»£ç†APå¿ƒè·³æ–¹æ¡ˆ" class="article-share-link"><span class="fa fa-share">åˆ†äº«</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/08/04/%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">å‰ä¸€ç¯‡</strong>
      <div class="article-nav-title">
        
          è“ç‰™è€³æœºå¼€å‘ç»éªŒ
        
      </div>
    </a>
  
  
    <a href="/2021/08/11/%E6%89%8B%E6%9C%BA%E4%BA%A7%E5%93%81%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">åä¸€ç¯‡</strong>
      <div class="article-nav-title">æ‰‹æœºäº§å“æŒ‡æ ‡ â€”â€” ç¨³å®šæ€§ï¼šæŠ€æœ¯å®è·µä¸äº§å“è§†è§’çš„ç»éªŒæ€»ç»“</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title">About Me</h3>
  <div class="widget about-widget">
    <div class="about-avatar">
      <img src="/images/shiba.jpg" alt="Avatar" />
    </div>
    <div class="about-info">
      <ul>
        <li><i class="fa fa-map-marker"></i> ä¸Šæµ·å¸‚é’æµ¦åŒº</li>
        <li><i class="fa fa-envelope"></i> luka_auto@163.com</li>
        <li><i class="fa fa-phone"></i> 177-1515-2023</li>
        <li><i class="fa fa-briefcase"></i> C/C++å·¥ç¨‹å¸ˆ @ åä¸º</li>
      </ul>
    </div>
    <div class="about-description">
      <p>ğŸ‘¤ æ ‡ç­¾ï¼šç¨‹åºå‘˜/toBå”®å‰/è§£å†³æ–¹æ¡ˆå·¥ç¨‹å¸ˆ/ç”µå­äº§å“å‘çƒ§å‹/AIå¿ å®ç”¨æˆ·ğŸ·ï¸</p>
      <p>âœ¨ 6å¹´å·¥ä½œç»éªŒï¼Œæ›¾å‚ä¸å¤šæ¬¾æ¶ˆè´¹ç”µå­äº§å“ç ”å‘ï¼Œç°è´Ÿè´£äº‘è®¡ç®—AI+æ•°æ®ç›¸å…³äº§å“ ğŸš€</p>
      <p>ğŸ’» è®¡ç®—æœºè¯­è¨€ï¼šC/C++/Python/Go/Java ğŸ› ï¸</p>
      <p>ğŸ¤– ç§¯ææ‹¥æŠ±AGIæ—¶ä»£ï¼ŒèŒä¸šå‘å±•å…¨é¢è½¬å‹ï¼Œæœªæ¥ç„å‡†AIåº”ç”¨é¢†åŸŸ ğŸ¯</p>
      <p>ğŸŒŸ è‡´åŠ›äºå‘å±•å¤šå…ƒåŒ–èƒ½åŠ›ï¼šäº§å“ã€è¿è¥ã€å”®å‰ã€å¼€å‘ç­‰ ğŸ’ª</p>
      <p>ğŸ• æ¬¢è¿å…³æ³¨å…¬ä¼—å·ï¼š<strong>å…­è¾¹å½¢çš„å°ç‹—</strong> ğŸ”</p>
    </div>
  </div>
</div>
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">51å•ç‰‡æœº</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSDN/" rel="tag">CSDN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github/" rel="tag">Github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hibernate/" rel="tag">Hibernate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDEA/" rel="tag">IDEA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySql/" rel="tag">MySql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/" rel="tag">Qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/" rel="tag">SpringMVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WiFi/" rel="tag">WiFi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/conclusion/" rel="tag">conclusion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/" rel="tag">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nrf24l01/" rel="tag">nrf24l01</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%A7%E5%93%81/" rel="tag">äº§å“</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">å•ç‰‡æœº</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2/" rel="tag">åšå®¢</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" rel="tag">å­¦ä¹ è·¯çº¿</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" rel="tag">åµŒå…¥å¼</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">æŠ€æœ¯</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag">æ“ä½œç³»ç»Ÿ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" rel="tag">æ•°å€¼è®¡ç®—</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">æ•°å­¦</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">æ•°æ®åº“</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">æ•°æ®ç»“æ„</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" rel="tag">æ–‡ä»¶æ“ä½œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A0%E7%BA%BF%E9%80%9A%E4%BF%A1/" rel="tag">æ— çº¿é€šä¿¡</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%AA%E6%AF%94%E5%B7%B4%E6%B3%A2%F0%9F%A4%90/" rel="tag">æ­ªæ¯”å·´æ³¢ğŸ¤</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" rel="tag">æµ·é‡æ•°æ®å¤„ç†</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%8F%E9%AA%8C/" rel="tag">ç»éªŒ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag">ç¼–ç¨‹</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">è®¡ç®—æœºç½‘ç»œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/" rel="tag">è½¯ä»¶å¼€å‘</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%98%BF%E9%87%8C/" rel="tag">é˜¿é‡Œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95/" rel="tag">é¢è¯•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%F0%9F%A4%90/" rel="tag">ğŸ¤</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/51%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 17.5px;">51å•ç‰‡æœº</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CSDN/" style="font-size: 10px;">CSDN</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Hibernate/" style="font-size: 10px;">Hibernate</a> <a href="/tags/IDEA/" style="font-size: 10px;">IDEA</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Maven/" style="font-size: 10px;">Maven</a> <a href="/tags/MySql/" style="font-size: 10px;">MySql</a> <a href="/tags/Qt/" style="font-size: 10px;">Qt</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/SpringMVC/" style="font-size: 10px;">SpringMVC</a> <a href="/tags/WiFi/" style="font-size: 10px;">WiFi</a> <a href="/tags/conclusion/" style="font-size: 10px;">conclusion</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/nrf24l01/" style="font-size: 10px;">nrf24l01</a> <a href="/tags/%E4%BA%A7%E5%93%81/" style="font-size: 10px;">äº§å“</a> <a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 17.5px;">å•ç‰‡æœº</a> <a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 10px;">åšå®¢</a> <a href="/tags/%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" style="font-size: 10px;">å­¦ä¹ è·¯çº¿</a> <a href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" style="font-size: 20px;">åµŒå…¥å¼</a> <a href="/tags/%E6%8A%80%E6%9C%AF/" style="font-size: 12.5px;">æŠ€æœ¯</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 10px;">æ“ä½œç³»ç»Ÿ</a> <a href="/tags/%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" style="font-size: 15px;">æ•°å€¼è®¡ç®—</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 15px;">æ•°å­¦</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10px;">æ•°æ®åº“</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">æ•°æ®ç»“æ„</a> <a href="/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/" style="font-size: 10px;">æ–‡ä»¶æ“ä½œ</a> <a href="/tags/%E6%97%A0%E7%BA%BF%E9%80%9A%E4%BF%A1/" style="font-size: 12.5px;">æ— çº¿é€šä¿¡</a> <a href="/tags/%E6%AD%AA%E6%AF%94%E5%B7%B4%E6%B3%A2%F0%9F%A4%90/" style="font-size: 10px;">æ­ªæ¯”å·´æ³¢ğŸ¤</a> <a href="/tags/%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" style="font-size: 10px;">æµ·é‡æ•°æ®å¤„ç†</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 15px;">ç®—æ³•</a> <a href="/tags/%E7%BB%8F%E9%AA%8C/" style="font-size: 10px;">ç»éªŒ</a> <a href="/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">ç¼–ç¨‹</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">è®¡ç®—æœºç½‘ç»œ</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/" style="font-size: 10px;">è½¯ä»¶å¼€å‘</a> <a href="/tags/%E9%98%BF%E9%87%8C/" style="font-size: 10px;">é˜¿é‡Œ</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 10px;">é¢è¯•</a> <a href="/tags/%F0%9F%A4%90/" style="font-size: 10px;">ğŸ¤</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">ä¸ƒæœˆ 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">ä¸‰æœˆ 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">å…«æœˆ 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">åäºŒæœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">ä¸‰æœˆ 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">åäºŒæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">åä¸€æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">å…­æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">å››æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">ä¸‰æœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">äºŒæœˆ 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">ä¸€æœˆ 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/07/27/2025.07.27%E6%97%A5%E8%AE%B0/">2025.07.27æ—¥è®°</a>
          </li>
        
          <li>
            <a href="/2025/07/24/2025.07.24%E6%97%A5%E8%AE%B0/">2025.07.24æ—¥è®°</a>
          </li>
        
          <li>
            <a href="/2024/03/08/Review/">Review</a>
          </li>
        
          <li>
            <a href="/2022/11/15/%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/">åµŒå…¥å¼è½¯ä»¶å¼€å‘å­¦ä¹ è·¯çº¿</a>
          </li>
        
          <li>
            <a href="/2022/08/04/%E8%93%9D%E7%89%99%E8%80%B3%E6%9C%BA%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/">è“ç‰™è€³æœºå¼€å‘ç»éªŒ</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Walking9<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>